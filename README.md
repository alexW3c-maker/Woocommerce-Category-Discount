# Woocommerce Category Discount

**Woocommerce Category Discount** плагин для WordPress и WooCommerce, который предоставляет скидки на определенные категории товаров и добавляет бесплатные продукты на страницу корзины.

## Особенности

- Предоставление скидки на выбранную категорию товаров
- Добавление выбранного бесплатного продукта на страницу корзины, если сумма товаров со скидкой превышает установленный порог
- Ограничение количества бесплатных продуктов в корзине
- Автоматическое удаление бесплатного продукта, если сумма товаров со скидкой меньше установленного порога
- Тестировался на версии WordPress 6.2, в стандартных темах Twenty Twenty-Three, Twenty Twenty-Two и Twenty Twenty-One. 

## Установка

1. Загрузите плагин в каталог `/wp-content/plugins/` или установите его через панель администратора WordPress.
2. Активируйте плагин на странице "Плагины" в панели администратора WordPress.

## Настройка

1. Откройте страницу настроек плагина "WooCommerce" > "Category Discount".
2. Выберите категорию товаров, на которую будет предоставляться скидка.
3. Установите порог суммы товаров со скидкой, после которого будет добавлен бесплатный продукт.
4. Выберите категорию товаров, из которой будут выбираться бесплатные продукты.
5. Сохраните изменения.

## Использование

1. Добавьте товары из выбранной категории со скидкой в корзину.
2. Если сумма товаров со скидкой превышает установленный порог, на странице корзины появится возможность выбрать один бесплатный продукт из списка.
3. Выберите бесплатный продукт и он будет добавлен в корзину автоматически с нулевой ценой.
4. Если сумма товаров со скидкой меньше установленного порога, бесплатный продукт будет автоматически удален из корзины.

## Функции PHP и JS

### PHP

- `register_admin_page()`: регистрация страницы настроек плагина в админ-панели
- `register_settings()`: регистрация настроек плагина
- `display_free_products()`: отображение списка доступных бесплатных продуктов в корзине
- `add_free_product_to_cart()`: добавление выбранного бесплатного продукта в корзину
- `set_free_product_price_zero()`: установка нулевой цены для бесплатного продукта в корзине
- `remove_quantity_input_for_free_product()`: удаление возможности изменения количества бесплатного продукта в корзине
- `remove_free_product_if_needed()`: удаление бесплатного продукта из корзины, если сумма товаров со скидкой меньше установленного порога
- `ajax_add_free_product()`: обработка AJAX-запроса на добавление бесплатного продукта в корзину

### JS

- `update_free_product()`: функция для обновления списка доступных бесплатных продуктов и добавления выбранного продукта в корзину
- Обработчики событий для обновления корзины при изменении количества товаров, удалении товара из корзины и обновлении корзины через AJAX.
